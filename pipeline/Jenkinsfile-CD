@Library('shared-library') _
pipeline {
  agent any
  environment {
    azcon = credentials('azure-pasha')
  }
   
   stages {       
    stage('Download Artifact Form Nexus') {
      steps {
        DownloadFromNexus()
      }
      }
    stage('Stop IIS') {
      steps {
        StopIIS()
      }
      }
    stage('DeployToIIS') {   
      steps{
        withCredentials([usernamePassword(credentialsId: 'vmdotnet-creds', passwordVariable: 'password', usernameVariable: 'username')]) {
        DeployToIIS(username, password)
       }
       }
       }
     stage('Start IIS') {
      steps {
        StartIIS()
      }
      }
    }
}
